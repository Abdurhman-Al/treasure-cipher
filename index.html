<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø² â€” ØªØ´ÙÙŠØ± Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</title>

  <style>
    body{
      font-family: system-ui, -apple-system, Segoe UI, Tahoma, Arial;
      margin: 24px;
      line-height: 1.65;
      background:#fff;
      color:#111;
    }
    .card{
      max-width: 980px;
      margin: 0 auto;
      padding: 18px;
      border: 1px solid #ddd;
      border-radius: 14px;
      background:#fff;
    }
    h1{ margin:0 0 12px; font-size: 22px; }
    label{ display:block; margin: 10px 0 6px; font-weight: 900; }

    textarea, input, select{
      width: 100%;
      box-sizing: border-box;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 15px;
      background:#fff;
    }
    textarea{ min-height: 110px; resize: vertical; }

    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 800px){ .row{ grid-template-columns:1fr; } }

    .btns{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      margin-top: 12px;
      align-items:center;
    }
    button{
      padding: 10px 14px;
      border: 0;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 900;
    }
    button.primary{ background:#111; color:#fff; }
    button.secondary{ background:#eee; }

    .hint{ color:#555; font-size: 13px; margin-top: 6px; }
    .small{ font-size: 12px; color:#666; }
    .hr{ height:1px; background:#eee; margin:16px 0; }

    /* Ø­Ù„ Ù…Ø´Ø§ÙƒÙ„ RTL Ù„Ù„Ø£Ø±Ù‚Ø§Ù…: Ø§Ù„Ø£Ø±Ù‚Ø§Ù… LTR Ù„ÙƒÙ† Ø¨Ù…Ø­Ø§Ø°Ø§Ø© ÙŠÙ…ÙŠÙ† + Ù…Ù†Ø¹ Ø§Ù„Ø§Ù†Ù‚Ù„Ø§Ø¨ */
    #out{
      direction: ltr;
      unicode-bidi: bidi-override;
      text-align: right;
    }

    .muted{ color:#777; font-weight:800; font-size: 12px; margin-top:10px; }

    .boxes{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      margin-top: 8px;
      direction: rtl;
      align-items:flex-start;
    }
    .boxword{
      border:1px solid #bbb;
      border-radius: 10px;
      padding:10px 12px;
      background:#fff;
      font-weight:900;
      /* Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚: Ù†Ø«Ø¨Øª ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… */
      direction: ltr;
      unicode-bidi: bidi-override;
      text-align: right;
    }

    .panel{
      border:1px dashed #ddd;
      border-radius: 12px;
      padding: 14px;
      background:#fafafa;
      display:none;
      margin-top: 10px;
    }
    .panel.open{ display:block; }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      background:#f2f2f2;
      padding:10px;
      border-radius:10px;
      white-space: pre-wrap;
    }
    code{ background:#f6f6f6; padding:2px 6px; border-radius:6px; }
  </style>
</head>

<body>
<div class="card">
  <h1>ğŸ” Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø² â€” ØªØ´ÙÙŠØ± Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</h1>

  <label>Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ</label>
  <textarea id="plain" placeholder="Ù…Ø«Ø§Ù„: ØªØ¬Ø¯ Ø§Ù„ÙƒÙ†Ø² ÙÙŠ ØµØ§Ù„Ø© Ø§Ù„Ø¨ÙŠØª"></textarea>

  <div class="row">
    <div>
      <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ´ÙÙŠØ± Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</label>
      <select id="mapStyle">
        <option value="seq">1) ØªØ³Ù„Ø³Ù„ÙŠ: Ø£=01ØŒ Ø¨=02â€¦</option>
        <option value="rev">2) Ù…Ø¹ÙƒÙˆØ³: Ø£=28ØŒ Ø¨=27â€¦</option>
        <option value="interleave">3) Ù…ØªÙ†Ø§ÙˆØ¨: Ø£=01ØŒ Ø¨=15ØŒ Øª=02ØŒ Ø«=16â€¦</option>
        <option value="odd">4) Ø§Ù„ÙØ±Ø¯ÙŠ (1ØŒ3ØŒ5ØŒ7â€¦)</option>
      </select>
      <div class="hint" id="modeHint"></div>
    </div>

    <div>
      <label>Ø¹Ø¯Ø¯ Ø£Ø²ÙˆØ§Ø¬ â€œØ§Ù„ØªÙ„Ù…ÙŠØ­â€ (Ø§Ù„Ù…ÙØªØ§Ø­)</label>
      <input id="hintCount" type="number" min="2" max="28" value="6" />
      <div class="small">Ù…Ø«Ø§Ù„: 6 â†’ ÙŠØ¹Ø·ÙŠÙƒ 6 Ø£Ø²ÙˆØ§Ø¬ Ù…Ø«Ù„: Ø§=01ØŒ Ø¨=15â€¦ (ØªÙ‚Ø¯Ø± ØªÙ†Ø³Ø®Ù‡ ÙˆØªØ¹Ø·ÙŠÙ‡ Ù„Ù„Ù…ØªØ³Ø§Ø¨Ù‚)</div>
    </div>
  </div>

  <div class="btns">
    <button class="secondary" id="genHintBtn">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ„Ù…ÙŠØ­</button>
    <button class="secondary" id="genFullKeyBtn">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…ÙØªØ§Ø­ ÙƒØ§Ù…Ù„ (Ù„Ù„Ù…Ù†Ø¸Ù‘Ù…)</button>
  </div>

  <label>Ø§Ù„ØªÙ„Ù…ÙŠØ­ (Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø°ÙŠ ØªØ¹Ø·ÙŠÙ‡ Ù„Ù„Ù…ØªØ³Ø§Ø¨Ù‚)</label>
  <textarea id="hintText" placeholder="Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„ØªÙ„Ù…ÙŠØ­ (Ù…Ø«Ù„Ø§Ù‹: Ø§=01ØŒ Ø¨=15ØŒ Øª=02...)"></textarea>

  <label>Ø§Ù„Ù…ÙØªØ§Ø­ ÙƒØ§Ù…Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ù„Ù…Ù†Ø¸Ù‘Ù… ÙÙ‚Ø·)</label>
  <textarea id="fullKeyText" placeholder="Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„Ù…ÙØªØ§Ø­ ÙƒØ§Ù…Ù„ Ø¥Ø°Ø§ Ø¶ØºØ·Øª Ø²Ø± Ø§Ù„ØªÙˆÙ„ÙŠØ¯"></textarea>

  <div class="hr"></div>

  <div class="btns">
    <button class="primary" id="encryptBtn">Ø´ÙÙ‘Ø±</button>
    <button class="secondary" id="decryptBtn">ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±</button>
    <button class="secondary" id="copyBtn">Ù†Ø³Ø® Ø§Ù„Ù†Ø§ØªØ¬</button>
    <button class="secondary" id="swapBtn">Ø¨Ø¯Ù‘Ù„ (Ø§Ù„Ù†Ø§ØªØ¬ â† Ø§Ù„Ù†Øµ)</button>
    <button class="secondary" id="clearBtn">Ù…Ø³Ø­</button>
    <button class="secondary" id="printBtn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø¨Ø·Ø§Ù‚Ø©</button>
  </div>

  <label>Ø§Ù„Ù†Ø§ØªØ¬</label>
  <textarea id="out" placeholder="Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙÙ‘Ø± Ø£Ùˆ Ø§Ù„Ù…ÙÙƒÙˆÙƒ"></textarea>

  <div class="muted" id="previewLabel" style="display:none;">Ù…Ø¹Ø§ÙŠÙ†Ø© (ÙƒÙ„Ù…Ø§Øª Ø¯Ø§Ø®Ù„ ØµÙ†Ø§Ø¯ÙŠÙ‚):</div>
  <div class="boxes" id="previewBoxes" style="display:none;"></div>

  <div class="hr"></div>

  <div class="btns" style="justify-content:space-between;">
    <div style="font-weight:900;">ğŸ“˜ Ø´Ø±Ø­ Ø³Ø±ÙŠØ¹</div>
    <button class="secondary" id="toggleHelpBtn">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø´Ø±Ø­</button>
  </div>
  <div class="panel" id="helpPanel">
    <div class="mono" id="helpText"></div>
  </div>
</div>

<script>
/* ===== Ø§Ù„Ø£Ø¨Ø¬Ø¯ÙŠØ© (Ù†ÙØ³ ØªØ±ØªÙŠØ¨ Ù…Ø´Ø±ÙˆØ¹Ùƒ) + ØªØ·Ø¨ÙŠØ¹ Ø¨Ø³ÙŠØ· ===== */
const ALPH = "Ø§Ø¨ØªØ«Ø¬Ø­Ø®Ø¯Ø°Ø±Ø²Ø³Ø´ØµØ¶Ø·Ø¸Ø¹ØºÙÙ‚ÙƒÙ„Ù…Ù†Ù‡ÙˆÙŠ";
const normMap = new Map([["Ø£","Ø§"],["Ø¥","Ø§"],["Ø¢","Ø§"],["Ù±","Ø§"],["Ø©","Ù‡"],["Ù‰","ÙŠ"]]);
const norm = ch => normMap.get(ch) ?? ch;

function pad2(n){ return String(n).padStart(2,"0"); }
function escapeHtml(s){
  return (s ?? "").toString().replace(/[&<>"']/g, c => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
  }[c]));
}

/* ===== Ø¨Ù†Ø§Ø¡ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø­Ø±ÙˆÙ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…ÙØªØ§Ø­ ===== */
function makeOrder(style){
  const base = ALPH.split("");

  if(style === "rev"){
    return [...base].reverse();
  }

  if(style === "interleave"){
    // Ù…ØªÙ†Ø§ÙˆØ¨: 1,15,2,16...
    const half = Math.ceil(base.length/2); // 14
    const A = base.slice(0,half);
    const B = base.slice(half);
    const out=[];
    for(let i=0;i<half;i++){
      if(A[i]) out.push(A[i]);
      if(B[i]) out.push(B[i]);
    }
    return out;
  }

  // seq Ùˆ odd: Ù†ÙØ³ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
  return base;
}

/* ===== Ø¨Ù†Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ (Ø­Ø±Ù->Ø±Ù‚Ù…) Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© ===== */
function makeMapping(style){
  const order = makeOrder(style);
  const map = new Map(); // Ø­Ø±Ù -> Ø±Ù‚Ù…
  const inv = new Map(); // Ø±Ù‚Ù… -> Ø­Ø±Ù

  for(let i=0;i<order.length;i++){
    let num;
    if(style === "odd"){
      // Ø§Ù„ÙØ±Ø¯ÙŠ: 1ØŒ3ØŒ5... (Ø­ØªÙ‰ 55)
      num = 1 + 2*i;
    }else{
      // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø·Ø±Ù‚: 1..28
      num = i + 1;
    }
    map.set(order[i], num);
    inv.set(num, order[i]);
  }
  return {order, map, inv};
}

/* ===== Ø§Ù„ØªØ´ÙÙŠØ± Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… =====
   - Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø©: Ø£Ø±Ù‚Ø§Ù… Ù…ÙØµÙˆÙ„Ø© Ø¨Ù…Ø³Ø§ÙØ©
   - Ø¨ÙŠÙ† Ø§Ù„ÙƒÙ„Ù…Ø§Øª: | (Ù…Ø¹ Ù…Ø³Ø§ÙØ§Øª Ø­ÙˆÙ„Ù‡ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©)
   - Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù†Ø·Ø¨Ø¹Ù‡Ø§ Ø¨ØµÙŠØºØ© pad2 (01..55) Ù„ØªÙƒÙˆÙ† Ø£ÙˆØ¶Ø­
*/
function encodeNumbers(text, style){
  const {map} = makeMapping(style);
  const words = (text ?? "").trim().split(/\s+/).filter(Boolean);

  const encWords = words.map(w=>{
    const toks=[];
    for(const ch0 of w){
      const ch = norm(ch0);
      if(ALPH.includes(ch)){
        toks.push(pad2(map.get(ch)));
      }else{
        // Ù†ØªØ±Ùƒ Ø§Ù„Ø±Ù…ÙˆØ² ÙƒÙ…Ø§ Ù‡ÙŠ Ø¯Ø§Ø®Ù„ _ _ Ø­ØªÙ‰ Ù…Ø§ ØªØ¶ÙŠØ¹
        toks.push(`_${ch0}_`);
      }
    }
    return toks.join(" ");
  });

  return encWords.join(" | ");
}

function decodeNumbers(text, style){
  const {inv} = makeMapping(style);
  const t = (text ?? "").trim();
  const parts = t.split("|").map(s=>s.trim()).filter(Boolean);

  const outWords = parts.map(part=>{
    const toks = part.split(/\s+/).filter(Boolean);
    let out="";
    for(const tok of toks){
      if(tok.startsWith("_") && tok.endsWith("_") && tok.length>=3){
        out += tok.slice(1,-1);
        continue;
      }
      if(/^\d+$/.test(tok)){
        const n = parseInt(tok,10);
        out += inv.get(n) || "ï¿½";
      }else{
        out += tok;
      }
    }
    return out;
  });

  return outWords.join(" ");
}

/* ===== Ø§Ù„ØªÙ„Ù…ÙŠØ­/Ø§Ù„Ù…ÙØªØ§Ø­ ===== */
function buildHint(style, count){
  const {order, map} = makeMapping(style);
  const n = Math.max(2, Math.min(28, parseInt(count,10) || 6));
  return order.slice(0,n).map(ch => `${ch}=${pad2(map.get(ch))}`).join("ØŒ ");
}
function buildFullKey(style){
  const {order, map} = makeMapping(style);
  return order.map(ch => `${ch}=${pad2(map.get(ch))}`).join("ØŒ ");
}

/* ===== UI ===== */
const elPlain = document.getElementById("plain");
const elOut = document.getElementById("out");
const elStyle = document.getElementById("mapStyle");
const elHintCount = document.getElementById("hintCount");
const elHintText = document.getElementById("hintText");
const elFullKeyText = document.getElementById("fullKeyText");

const previewLabel = document.getElementById("previewLabel");
const previewBoxes = document.getElementById("previewBoxes");

const elModeHint = document.getElementById("modeHint");
const helpPanel = document.getElementById("helpPanel");
const helpText = document.getElementById("helpText");
const toggleHelpBtn = document.getElementById("toggleHelpBtn");

function updateTexts(){
  const s = elStyle.value;
  const labels = {
    seq: "ØªØ³Ù„Ø³Ù„ÙŠ: Ø£=01ØŒ Ø¨=02 â€¦ Ø­ØªÙ‰ 28",
    rev: "Ù…Ø¹ÙƒÙˆØ³: Ø£=28ØŒ Ø¨=27 â€¦",
    interleave: "Ù…ØªÙ†Ø§ÙˆØ¨: Ø£=01ØŒ Ø¨=15ØŒ Øª=02ØŒ Ø«=16â€¦",
    odd: "Ø§Ù„ÙØ±Ø¯ÙŠ: Ø£=01ØŒ Ø¨=03ØŒ Øª=05â€¦ (ÙƒÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙØ±Ø¯ÙŠØ©)"
  };
  elModeHint.textContent = labels[s] || "";

  const hintDesc = (s==="odd")
    ? "Ø§Ù„ÙÙƒØ±Ø©: ÙƒÙ„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙØ±Ø¯ÙŠØ© (1ØŒ3ØŒ5ØŒ7â€¦)."
    : "Ø§Ù„ÙÙƒØ±Ø©: Ø¬Ø¯ÙˆÙ„ ØªØ±Ù‚ÙŠÙ… Ø­Ø³Ø¨ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©.";

  helpText.textContent =
`Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬:
- Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒÙ„Ù…Ø©: Ø£Ø±Ù‚Ø§Ù… Ù…ÙØµÙˆÙ„Ø© Ø¨Ù…Ø³Ø§ÙØ©
- Ø¨ÙŠÙ† Ø§Ù„ÙƒÙ„Ù…Ø§Øª: |  (Ù…Ø«Ø§Ù„: 03 05 08 | 01 23 ...)

Ø§Ù„ØªÙ„Ù…ÙŠØ­:
- Ø§Ø¶ØºØ· â€œØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ„Ù…ÙŠØ­â€ Ù„ØªØ£Ø®Ø° 5 Ø£Ùˆ 6 Ø£Ø²ÙˆØ§Ø¬ ÙˆØªØ¶Ø¹Ù‡Ø§ Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ±Ù‚Ø© Ù„Ù„Ù…ØªØ³Ø§Ø¨Ù‚ÙŠÙ†.

${hintDesc}

Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©:
- ØªÙ… ØªØ«Ø¨ÙŠØª Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø­ØªÙ‰ Ù„Ø§ ØªÙ†Ù‚Ù„Ø¨ ÙÙŠ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø£Ùˆ ÙÙŠ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ù†Ø§ØªØ¬.`;
}

function renderBoxesPreview(){
  const v = (elOut.value || "").trim();
  if(!v.includes("|")){
    previewLabel.style.display="none";
    previewBoxes.style.display="none";
    previewBoxes.innerHTML="";
    return;
  }
  const words = v.split("|").map(s=>s.trim()).filter(Boolean);
  previewBoxes.innerHTML = words.map(w => `<div class="boxword">${escapeHtml(w)}</div>`).join("");
  previewLabel.style.display="block";
  previewBoxes.style.display="flex";
}

/* ===== Ø£Ø²Ø±Ø§Ø± ===== */
function encrypt(){
  const style = elStyle.value;
  elOut.value = encodeNumbers(elPlain.value, style);
  renderBoxesPreview();
}
function decrypt(){
  const style = elStyle.value;
  elOut.value = decodeNumbers(elPlain.value, style);
  renderBoxesPreview();
}
async function copyOut(){
  try{
    await navigator.clipboard.writeText(elOut.value);
    alert("ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…");
  }catch{
    elOut.select();
    document.execCommand("copy");
    alert("ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…");
  }
}
function swapOut(){
  elPlain.value = elOut.value;
  elOut.value = "";
  renderBoxesPreview();
}
function clearAll(){
  elPlain.value = "";
  elOut.value = "";
  elHintText.value = "";
  elFullKeyText.value = "";
  renderBoxesPreview();
}

function genHint(){
  elHintText.value = buildHint(elStyle.value, elHintCount.value);
}
function genFullKey(){
  elFullKeyText.value = buildFullKey(elStyle.value);
}

/* ===== Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ===== */
function printCard(){
  const cipher = (elOut.value || "").trim();
  if(!cipher){
    alert("Ø´ÙÙ‘Ø± Ø§Ù„Ù†Øµ Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø§Ø·Ø¨Ø¹.");
    return;
  }
  const hint = (elHintText.value || "").trim();

  // Ø¥Ù† Ù„Ù… ÙŠÙˆØ¬Ø¯ | Ù†Ø·Ø¨Ø¹ ÙƒØ³Ø·Ø± ÙˆØ§Ø­Ø¯
  const parts = cipher.includes("|")
    ? cipher.split("|").map(s=>s.trim()).filter(Boolean)
    : [cipher];

  const boxes = parts.map(w => `
    <div style="direction:ltr;unicode-bidi:bidi-override;text-align:right;border:1px solid #bbb;border-radius:12px;padding:10px 12px;font-size:18px;font-weight:900;margin:4px;">
      ${escapeHtml(w)}
    </div>
  `).join("");

  const html = `<!doctype html><html lang="ar" dir="rtl"><head><meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Ø¨Ø·Ø§Ù‚Ø© Ù„ØºØ²</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Tahoma,Arial;margin:24px;line-height:1.7;}
    .box{border:2px solid #111;border-radius:14px;padding:16px;max-width:900px;}
    .hint{margin-top:12px;font-size:14px;}
    @media print{body{margin:0}.box{border:0;border-radius:0}}
  </style></head><body>
  <div class="box">
    <h2 style="margin:0 0 10px;">ğŸ—ï¸ Ø¨Ø·Ø§Ù‚Ø© Ù„ØºØ² â€” Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø²</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap;direction:rtl;align-items:flex-start;">${boxes}</div>
    <div class="hint"><b>Ø§Ù„Ù…ÙØªØ§Ø­ / Ø§Ù„ØªÙ„Ù…ÙŠØ­:</b> ${hint ? escapeHtml(hint) : "(Ø¶Ø¹ Ø§Ù„ØªÙ„Ù…ÙŠØ­ Ù‡Ù†Ø§)"}</div>
  </div>
  </body></html>`;

  const w = window.open("","_blank");
  w.document.open();
  w.document.write(html);
  w.document.close();
  w.focus();
  setTimeout(()=>w.print(), 200);
}

/* ===== Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ===== */
document.getElementById("encryptBtn").addEventListener("click", encrypt);
document.getElementById("decryptBtn").addEventListener("click", decrypt);
document.getElementById("copyBtn").addEventListener("click", copyOut);
document.getElementById("swapBtn").addEventListener("click", swapOut);
document.getElementById("clearBtn").addEventListener("click", clearAll);
document.getElementById("printBtn").addEventListener("click", printCard);

document.getElementById("genHintBtn").addEventListener("click", genHint);
document.getElementById("genFullKeyBtn").addEventListener("click", genFullKey);

toggleHelpBtn.addEventListener("click", ()=>{
  helpPanel.classList.toggle("open");
  toggleHelpBtn.textContent = helpPanel.classList.contains("open") ? "Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø´Ø±Ø­" : "Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø´Ø±Ø­";
});

elStyle.addEventListener("change", ()=>{
  updateTexts();
});

/* Ø¨Ø¯Ø¡ */
updateTexts();
helpPanel.classList.remove("open");
</script>
</body>
</html>
