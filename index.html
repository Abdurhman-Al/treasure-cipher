<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø² - ØªØ´ÙÙŠØ± Ø§Ù„Ù†Øµ</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Tahoma, Arial; margin: 24px; line-height: 1.6; }
    .card { max-width: 980px; margin: 0 auto; padding: 18px; border: 1px solid #ddd; border-radius: 14px; }
    h1 { margin: 0 0 12px; font-size: 22px; }
    label { display:block; margin: 10px 0 6px; font-weight: 600; }
    textarea, input, select { width: 100%; box-sizing: border-box; padding: 10px; border-radius: 10px; border: 1px solid #ccc; font-size: 15px; }
    textarea { min-height: 110px; resize: vertical; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .btns { display:flex; gap:10px; flex-wrap: wrap; margin-top: 12px; }
    button { padding: 10px 14px; border: 0; border-radius: 10px; cursor: pointer; font-weight: 700; }
    button.primary { background: #111; color: #fff; }
    button.secondary { background: #eee; }
    .hint { color:#555; font-size: 13px; margin-top: 6px; }
    .small { font-size: 12px; color:#666; }
    @media (max-width: 800px){ .row{grid-template-columns: 1fr;} }
    code { background:#f6f6f6; padding: 2px 6px; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ” Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø² â€” ØªØ´ÙÙŠØ± / ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ù†Øµ</h1>

    <label>Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ</label>
    <textarea id="plain" placeholder="Ù…Ø«Ø§Ù„: ØªØ¬Ø¯ Ø§Ù„ÙƒÙ†Ø² ÙÙŠ ØµØ§Ù„Ø© Ø§Ù„Ø¨ÙŠØª"></textarea>

    <div class="row">
      <div>
        <label>Ù†ÙˆØ¹ Ø§Ù„Ø´ÙØ±Ø©</label>
        <select id="mode">
          <option value="arabic_numbers">1) ØªØ±Ù‚ÙŠÙ… Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ø£=1...)</option>
          <option value="caesar_ar">2) Ù‚ÙŠØµØ± Ø¹Ø±Ø¨ÙŠ (Ø¥Ø²Ø§Ø­Ø©)</option>
          <option value="vigenere_ar">3) VigenÃ¨re Ø¹Ø±Ø¨ÙŠ (Ù…ÙØªØ§Ø­ ÙƒÙ„Ù…Ø©)</option>
          <option value="atbash_ar">4) Atbash Ø¹Ø±Ø¨ÙŠ (Ø¹ÙƒØ³ Ø§Ù„Ø­Ø±ÙˆÙ)</option>
          <option value="base64">5) Base64 Ù„Ù„Ù†Øµ</option>
        </select>
        <div class="hint" id="modeHint"></div>
      </div>

      <div>
        <label>Ø§Ù„Ù…ÙØªØ§Ø­ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ø´ÙØ±Ø©)</label>
        <input id="key" placeholder="Ù…Ø«Ø§Ù„: 3 Ø£Ùˆ ÙƒÙ„Ù…Ø© Ù…Ø«Ù„: ÙƒÙ†Ø²" />
        <div class="small">Ù‚ÙŠØµØ±: Ø±Ù‚Ù… (Ù…Ø«Ù„ 3) â€” VigenÃ¨re: ÙƒÙ„Ù…Ø© Ø¹Ø±Ø¨ÙŠØ© (Ù…Ø«Ù„ ÙƒÙ†Ø²) â€” Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ù„Ø§ ÙŠØ­ØªØ§Ø¬</div>
      </div>
    </div>

    <div class="btns">
      <button class="primary" id="encryptBtn">Ø´ÙÙ‘Ø±</button>
      <button class="secondary" id="decryptBtn">ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±</button>
      <button class="secondary" id="copyBtn">Ù†Ø³Ø® Ø§Ù„Ù†Ø§ØªØ¬</button>
      <button class="secondary" id="swapBtn">Ø¨Ø¯Ù‘Ù„ (Ø§Ù„Ù†Ø§ØªØ¬ â† Ø§Ù„Ù†Øµ)</button>
      <button class="secondary" id="clearBtn">Ù…Ø³Ø­</button>
    </div>

    <label>Ø§Ù„Ù†Ø§ØªØ¬</label>
    <textarea id="out" placeholder="Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙÙ‘Ø± Ø£Ùˆ Ø§Ù„Ù…ÙÙƒÙˆÙƒ"></textarea>

    <p class="small">
      âœ… Ù‡Ø°Ø§ Ù…Ù†Ø§Ø³Ø¨ Ù„Ø£Ù„ØºØ§Ø² â€œÙ„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø²â€. Ù„ÙŠØ³ Ù„Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ø£Ù…Ù†ÙŠ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ.
    </p>
  </div>

<script>
/** ===== Alphabet handling (Arabic) =====
 * Ù†Ø³ØªØ®Ø¯Ù… Ø£Ø¨Ø¬Ø¯ÙŠØ© Ø¹Ø±Ø¨ÙŠØ© â€œÙ…Ø¨Ø³Ø·Ø©â€ Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¥Ø²Ø§Ø­Ø©.
 * Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ù…Ø®ØªÙ„ÙØ© Ù…Ø«Ù„ (Ø£ØŒØ¥ØŒØ¢) Ù†Ø­ÙˆÙ„Ù‡Ø§ Ø¥Ù„Ù‰ (Ø§) Ø¹Ø´Ø§Ù† ØªÙƒÙˆÙ† Ø§Ù„Ù„Ø¹Ø¨Ø© Ø³Ù‡Ù„Ø©.
 */
const ALPH = "Ø§Ø¨ØªØ«Ø¬Ø­Ø®Ø¯Ø°Ø±Ø²Ø³Ø´ØµØ¶Ø·Ø¸Ø¹ØºÙÙ‚ÙƒÙ„Ù…Ù†Ù‡ÙˆÙŠ";
const normMap = new Map([
  ["Ø£","Ø§"],["Ø¥","Ø§"],["Ø¢","Ø§"],["Ù±","Ø§"],
  ["Ø©","Ù‡"],["Ù‰","ÙŠ"],
]);

function normalizeArabicChar(ch){
  return normMap.get(ch) ?? ch;
}

function isArabicLetter(ch){
  const c = normalizeArabicChar(ch);
  return ALPH.includes(c);
}

function alphaIndex(ch){
  const c = normalizeArabicChar(ch);
  return ALPH.indexOf(c);
}

function shiftArabicChar(ch, shift){
  const c = normalizeArabicChar(ch);
  const i = ALPH.indexOf(c);
  if (i === -1) return ch;
  const n = ALPH.length;
  const j = (i + ((shift % n) + n) ) % n;
  return ALPH[j];
}

/** ===== 1) Arabic letters to numbers ===== */
function arabicToNumbers(text){
  // ÙƒÙ„ Ø­Ø±Ù Ø¹Ø±Ø¨ÙŠ -> Ø±Ù‚Ù… (1..N). Ù†ÙØµÙ„Ù‡Ø§ Ø¨Ø´Ø±Ø·Ø©.
  const parts = [];
  for (const ch of text){
    if (isArabicLetter(ch)){
      parts.push(String(alphaIndex(ch) + 1));
    } else {
      // Ù†Ø®Ù„ÙŠ Ø§Ù„Ù…Ø³Ø§ÙØ© / Ø§Ù„Ø±Ù…ÙˆØ² ÙƒÙ…Ø§ Ù‡ÙŠ Ù„ÙƒÙ† Ø¨ÙØ§ØµÙ„ ÙˆØ§Ø¶Ø­
      if (ch === " ") parts.push("|"); // ÙØ§ØµÙ„ ÙƒÙ„Ù…Ø§Øª
      else parts.push(ch);
    }
  }
  return parts.join("-");
}

function numbersToArabic(text){
  // Ù†ØªÙˆÙ‚Ø¹ ØµÙŠØºØ©: 1-2-| -... Ù…Ø¹ | ÙƒÙØ§ØµÙ„ ÙƒÙ„Ù…Ø§Øª
  // Ù†Ø³Ù…Ø­ Ø¨ÙˆØ¬ÙˆØ¯ Ø­Ø±ÙˆÙ/Ø±Ù…ÙˆØ² Ø®Ø§Ø±Ø¬ÙŠØ©
  const tokens = text.split("-");
  let out = "";
  for (const t of tokens){
    if (t === "|") { out += " "; continue; }
    if (/^\d+$/.test(t)){
      const num = parseInt(t,10);
      if (num >= 1 && num <= ALPH.length) out += ALPH[num-1];
      else out += t; // Ø±Ù‚Ù… Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚
    } else {
      // token Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø±Ù…Ø² Ø£Ùˆ Ø­Ø±Ù
      out += t;
    }
  }
  return out;
}

/** ===== 2) Caesar Arabic ===== */
function caesarEncrypt(text, key){
  const s = parseInt(key,10);
  if (Number.isNaN(s)) return "âš ï¸ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù…Ù‹Ø§ ÙÙŠ Ø§Ù„Ù…ÙØªØ§Ø­ (Ù…Ø«Ù„ 3)";
  let out = "";
  for (const ch of text) out += shiftArabicChar(ch, s);
  return out;
}
function caesarDecrypt(text, key){
  const s = parseInt(key,10);
  if (Number.isNaN(s)) return "âš ï¸ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù…Ù‹Ø§ ÙÙŠ Ø§Ù„Ù…ÙØªØ§Ø­ (Ù…Ø«Ù„ 3)";
  let out = "";
  for (const ch of text) out += shiftArabicChar(ch, -s);
  return out;
}

/** ===== 3) VigenÃ¨re Arabic (by shifts) ===== */
function vigenereEncrypt(text, keyWord){
  keyWord = (keyWord || "").trim();
  if (!keyWord) return "âš ï¸ Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…ÙØªØ§Ø­ (Ù…Ø«Ù„: ÙƒÙ†Ø²)";
  // Ù†Ø¨Ù†ÙŠ Ø¥Ø²Ø§Ø­Ø§Øª Ù…Ù† Ø­Ø±ÙˆÙ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙÙ‚Ø·
  const shifts = [];
  for (const ch of keyWord){
    if (isArabicLetter(ch)) shifts.push(alphaIndex(ch));
  }
  if (!shifts.length) return "âš ï¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† ÙÙŠÙ‡ Ø­Ø±ÙˆÙ Ø¹Ø±Ø¨ÙŠØ©";
  let ki = 0;
  let out = "";
  for (const ch of text){
    if (isArabicLetter(ch)){
      const sh = shifts[ki % shifts.length];
      out += shiftArabicChar(ch, sh);
      ki++;
    } else out += ch;
  }
  return out;
}
function vigenereDecrypt(text, keyWord){
  keyWord = (keyWord || "").trim();
  if (!keyWord) return "âš ï¸ Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…ÙØªØ§Ø­ (Ù…Ø«Ù„: ÙƒÙ†Ø²)";
  const shifts = [];
  for (const ch of keyWord){
    if (isArabicLetter(ch)) shifts.push(alphaIndex(ch));
  }
  if (!shifts.length) return "âš ï¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† ÙÙŠÙ‡ Ø­Ø±ÙˆÙ Ø¹Ø±Ø¨ÙŠØ©";
  let ki = 0;
  let out = "";
  for (const ch of text){
    if (isArabicLetter(ch)){
      const sh = shifts[ki % shifts.length];
      out += shiftArabicChar(ch, -sh);
      ki++;
    } else out += ch;
  }
  return out;
}

/** ===== 4) Atbash Arabic ===== */
function atbash(text){
  const n = ALPH.length;
  let out = "";
  for (const ch of text){
    const c = normalizeArabicChar(ch);
    const i = ALPH.indexOf(c);
    if (i === -1) out += ch;
    else out += ALPH[(n - 1) - i];
  }
  return out;
}

/** ===== 5) Base64 (UTF-8 safe) ===== */
function toBase64Unicode(str){
  // encodeURIComponent -> bytes
  const utf8 = encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (_,p)=>String.fromCharCode(parseInt(p,16)));
  return btoa(utf8);
}
function fromBase64Unicode(b64){
  const bytes = atob(b64);
  const esc = Array.from(bytes, c => "%" + c.charCodeAt(0).toString(16).padStart(2,"0")).join("");
  return decodeURIComponent(esc);
}

/** ===== UI wiring ===== */
const elPlain = document.getElementById("plain");
const elOut   = document.getElementById("out");
const elMode  = document.getElementById("mode");
const elKey   = document.getElementById("key");
const elHint  = document.getElementById("modeHint");

function updateHint(){
  const m = elMode.value;
  const hints = {
    arabic_numbers: "ÙŠØ­Ù‘ÙˆÙ„ ÙƒÙ„ Ø­Ø±Ù Ø¹Ø±Ø¨ÙŠ Ù„Ø±Ù‚Ù…. Ø§Ù„Ù…Ø³Ø§ÙØ© ØªØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ |",
    caesar_ar: "Ø¥Ø²Ø§Ø­Ø© Ø¨Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©. Ø§Ù„Ù…ÙØªØ§Ø­ Ø±Ù‚Ù… Ù…Ø«Ù„ 3",
    vigenere_ar: "Ù…ÙØªØ§Ø­ ÙƒÙ„Ù…Ø© Ø¹Ø±Ø¨ÙŠØ© (Ù…Ø«Ù„ ÙƒÙ†Ø²). ÙƒÙ„ Ø­Ø±Ù ÙÙŠ Ø§Ù„Ù…ÙØªØ§Ø­ ÙŠØ¹Ø·ÙŠ Ø¥Ø²Ø§Ø­Ø©",
    atbash_ar: "ÙŠØ¹ÙƒØ³ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø­Ø±ÙˆÙ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø£Ø¨Ø¬Ø¯ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ø¨Ø¯ÙˆÙ† Ù…ÙØªØ§Ø­)",
    base64: "Ù…ÙÙŠØ¯ Ù„Ù„Ù†Ø³Ø®/Ø§Ù„Ù„ØµÙ‚. Ù„ÙŠØ³ Ù„ØºØ²Ù‹Ø§ Ù‚ÙˆÙŠÙ‹Ø§ Ù„ÙƒÙ†Ù‡ Ø¹Ù…Ù„ÙŠ",
  };
  elHint.textContent = hints[m] || "";
}
updateHint();
elMode.addEventListener("change", updateHint);

function encrypt(){
  const text = elPlain.value;
  const key  = elKey.value;
  const m    = elMode.value;

  if (m === "arabic_numbers") elOut.value = arabicToNumbers(text);
  else if (m === "caesar_ar") elOut.value = caesarEncrypt(text, key);
  else if (m === "vigenere_ar") elOut.value = vigenereEncrypt(text, key);
  else if (m === "atbash_ar") elOut.value = atbash(text);
  else if (m === "base64") elOut.value = toBase64Unicode(text);
}

function decrypt(){
  const text = elPlain.value;
  const key  = elKey.value;
  const m    = elMode.value;

  try{
    if (m === "arabic_numbers") elOut.value = numbersToArabic(text);
    else if (m === "caesar_ar") elOut.value = caesarDecrypt(text, key);
    else if (m === "vigenere_ar") elOut.value = vigenereDecrypt(text, key);
    else if (m === "atbash_ar") elOut.value = atbash(text); // Ù†ÙØ³ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
    else if (m === "base64") elOut.value = fromBase64Unicode(text);
  } catch(e){
    elOut.value = "âš ï¸ Ù…Ø§ Ù‚Ø¯Ø±Øª Ø£ÙÙƒ Ø§Ù„Ù†Øµ. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª.";
  }
}

document.getElementById("encryptBtn").addEventListener("click", encrypt);
document.getElementById("decryptBtn").addEventListener("click", decrypt);

document.getElementById("copyBtn").addEventListener("click", async ()=>{
  try{
    await navigator.clipboard.writeText(elOut.value);
    alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Ø§ØªØ¬ âœ…");
  }catch{
    // fallback
    elOut.select();
    document.execCommand("copy");
    alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Ø§ØªØ¬ âœ…");
  }
});

document.getElementById("swapBtn").addEventListener("click", ()=>{
  elPlain.value = elOut.value;
  elOut.value = "";
});

document.getElementById("clearBtn").addEventListener("click", ()=>{
  elPlain.value = "";
  elOut.value = "";
  elKey.value = "";
});
</script>
</body>
</html>
